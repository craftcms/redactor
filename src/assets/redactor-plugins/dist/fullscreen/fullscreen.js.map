{"version":3,"sources":["fullscreen/fullscreen.js"],"names":["$R","add","translations","en","fullscreen","init","app","this","opts","lang","$win","$doc","$body","editor","toolbar","container","selection","isOpen","docScroll","start","data","title","get","api","addButton","setIcon","$target","isTarget","getTargetElement","toggle","close","open","scrollTop","_createPlacemarker","save","$container","getElement","$editor","$html","dom","toolbarExternal","_buildInternalToolbar","prepend","addClass","css","maxHeight","minHeight","_resize","on","bind","getButton","restore","zindex","window","jQuery","document","off","_buildExternalToolbar","removeClass","_removePlacemarker","$toolbar","height","$wrapper","getWrapper","append","$external","remove","$placemarker","after","before","Redactor"],"mappings":"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","file":"fullscreen.js","sourcesContent":["(function($R)\n{\n    $R.add('plugin', 'fullscreen', {\n        translations: {\n            en: {\n    \t\t\t\"fullscreen\": \"Fullscreen\"\n    \t\t}\n        },\n        init: function(app)\n        {\n            this.app = app;\n            this.opts = app.opts;\n            this.lang = app.lang;\n            this.$win = app.$win;\n            this.$doc = app.$doc;\n            this.$body = app.$body;\n            this.editor = app.editor;\n            this.toolbar = app.toolbar;\n            this.container = app.container;\n            this.selection = app.selection;\n\n            // local\n            this.isOpen = false;\n            this.docScroll = 0;\n        },\n        // public\n        start: function()\n        {\n            var data = {\n                title: this.lang.get('fullscreen'),\n                api: 'plugin.fullscreen.toggle'\n            };\n\n            var button = this.toolbar.addButton('fullscreen', data);\n            button.setIcon('<i class=\"re-icon-expand\"></i>');\n\n            this.$target = (this.toolbar.isTarget()) ? this.toolbar.getTargetElement() : this.$body;\n\n\t\t\tif (this.opts.fullscreen) this.toggle();\n\n        },\n        toggle: function()\n\t\t{\n\t\t\treturn (this.isOpen) ? this.close() : this.open();\n\t\t},\n\t\topen: function()\n\t\t{\n    \t\tthis.docScroll = this.$doc.scrollTop();\n\n            this._createPlacemarker();\n            this.selection.save();\n\n            var $container = this.container.getElement();\n            var $editor = this.editor.getElement();\n            var $html = (this.toolbar.isTarget()) ? $R.dom('body, html') : this.$target;\n\n            if (this.opts.toolbarExternal) this._buildInternalToolbar();\n\n            this.$target.prepend($container);\n\t\t\tthis.$target.addClass('redactor-body-fullscreen');\n\n            $container.addClass('redactor-box-fullscreen');\n            if (this.isTarget) $container.addClass('redactor-box-fullscreen-target');\n\n            $html.css('overflow', 'hidden');\n\n            if (this.opts.maxHeight) $editor.css('max-height', '');\n            if (this.opts.minHeight) $editor.css('min-height', '');\n\n            this._resize();\n            this.$win.on('resize.redactor-plugin-fullscreen', this._resize.bind(this));\n\t\t\tthis.$doc.scrollTop(0);\n\n            var button = this.toolbar.getButton('fullscreen');\n            button.setIcon('<i class=\"re-icon-retract\"></i>');\n\n            this.selection.restore();\n\t\t\tthis.isOpen = true;\n\t\t\tthis.opts.zindex = 1051;\n\t\t\t// fix bootstrap modal focus\n            if (window.jQuery) window.jQuery(document).off('focusin.modal');\n\t\t},\n\t\tclose: function()\n\t\t{\n    \t\tthis.isOpen = false;\n\t\t\tthis.opts.zindex = false;\n            this.selection.save();\n\n            var $container = this.container.getElement();\n            var $editor = this.editor.getElement();\n            var $html = $R.dom('body, html');\n\n            if (this.opts.toolbarExternal) this._buildExternalToolbar();\n\n            this.$target.removeClass('redactor-body-fullscreen');\n    \t\tthis.$win.off('resize.redactor-plugin-fullscreen');\n            $html.css('overflow', '');\n\n\t\t\t$container.removeClass('redactor-box-fullscreen redactor-box-fullscreen-target');\n\t\t\t$editor.css('height', 'auto');\n\n\t\t\tif (this.opts.minHeight) $editor.css('minHeight', this.opts.minHeight);\n\t\t\tif (this.opts.maxHeight) $editor.css('maxHeight', this.opts.maxHeight);\n\n            var button = this.toolbar.getButton('fullscreen');\n            button.setIcon('<i class=\"re-icon-expand\"></i>');\n\n    \t\tthis._removePlacemarker($container);\n            this.selection.restore();\n            this.$doc.scrollTop(this.docScroll);\n\t\t},\n\n\t\t// private\n\t\t_resize: function()\n\t\t{\n    \t\tvar $toolbar = this.toolbar.getElement();\n            var $editor = this.editor.getElement();\n    \t\tvar height = this.$win.height() - $toolbar.height();\n\n    \t\t$editor.height(height);\n\t\t},\n\t\t_buildInternalToolbar: function()\n\t\t{\n\t\t\tvar $wrapper = this.toolbar.getWrapper();\n\t\t\tvar $toolbar = this.toolbar.getElement();\n\n\t\t\t$wrapper.addClass('redactor-toolbar-wrapper');\n\t\t\t$wrapper.append($toolbar);\n\n\t\t\t$toolbar.removeClass('redactor-toolbar-external');\n\t\t\t$container.prepend($wrapper);\n\t\t},\n\t\t_buildExternalToolbar: function()\n\t\t{\n\t\t\tvar $wrapper = this.toolbar.getWrapper();\n\t\t\tvar $toolbar = this.toolbar.getElement();\n\n            this.$external = $R.dom(this.opts.toolbarExternal);\n\n            $toolbar.addClass('redactor-toolbar-external');\n            this.$external.append($toolbar);\n\n            $wrapper.remove();\n\t\t},\n\t\t_createPlacemarker: function()\n\t\t{\n    \t\tvar $container = this.container.getElement();\n\n    \t\tthis.$placemarker = $R.dom('<span />');\n    \t\t$container.after(this.$placemarker);\n\t\t},\n\t\t_removePlacemarker: function($container)\n\t\t{\n    \t\tthis.$placemarker.before($container);\n            this.$placemarker.remove();\n\t\t}\n    });\n})(Redactor);"]}