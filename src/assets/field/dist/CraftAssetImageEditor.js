!function(){var e=$.extend({},Craft.Redactor.PluginBase,{assetId:null,start:function(){},open:function(e){this.assetId=e;var a={allowSavingAsNew:!1,onSave:this.reloadImage.bind(this),allowDegreeFractions:Craft.isImagick};new Craft.AssetImageEditor(e,a)},reloadImage:function(){var e=this.app.editor.getElement().find("[data-image]"),a=function(e){var a=e.src.match(/(.*)#asset:(\d+)(:transform:(.*))?/i);if(a&&a[2]==this.assetId)if(a[4]){var t={assetId:a[2],handle:a[4]};Craft.sendActionRequest("POST","assets/generate-transform",{data:t}).then((function(t){e.src=t.data.url+"?"+(new Date).getTime()+"#asset:"+a[2]+":transform:"+a[4]}))}else e.src=a[1]+"?"+(new Date).getTime()+"#asset:"+a[2]}.bind(this);for(var t in e.nodes)a(t=e.nodes[t]);this.app.storage.observeImages()}});Redactor.add("plugin","craftAssetImageEditor",e)}();
//# sourceMappingURL=CraftAssetImageEditor.js.map