{"version":3,"sources":["CraftAssetFiles.js"],"names":["plugin","$","extend","Craft","Redactor","PluginBase","title","apiTarget","icon","volumes","showModal","this","saveSelection","app","assetSelectionModal","arguments","refHandle","createElementSelectorModal","storageKey","sources","criteria","siteId","elementSiteId","onSelect","proxy","elements","length","restoreSelection","element","selectedText","selection","getText","data","url","id","text","label","api","closeOtherModals","show","setVolumes","add"],"mappings":"AAAA,IAAIA,OAASC,EAAEC,OAAO,GAAIC,MAAMC,SAASC,WAAY,CACnDC,MAAO,OACPC,UAAW,mCACXC,KAAM,+BACNC,QAAS,KAETC,UAAW,WAGT,GAFAC,KAAKC,cAAcD,KAAKE,UAEgB,IAA7BF,KAAKG,oBAAqC,CACnCC,UAAUC,UAC1BL,KAAKG,oBAAsBX,MAAMc,2BAC/B,yBACA,CACEC,WAAY,4BACZC,QAASR,KAAKF,QACdW,SAAU,CAACC,OAAQV,KAAKW,eACxBC,SAAUtB,EAAEuB,OAAM,SAAUC,GAC1B,GAAIA,EAASC,OAAQ,CACnBf,KAAKgB,iBAAiBhB,KAAKE,KAC3B,MAAMe,EAAUH,EAAS,GACnBI,EAAelB,KAAKE,IAAIiB,UAAUC,UAClCC,EAAO,CACXC,IAAKL,EAAQK,IAAM,UAAYL,EAAQM,GACvCC,KAAMN,EAAaH,OAAS,EAAIG,EAAeD,EAAQQ,OAEzDzB,KAAKE,IAAIwB,IAAI,qBAAsBL,MAEpCrB,MACH2B,kBAAkB,SAItB3B,KAAKG,oBAAoByB,QAI7BC,WAAY,SAAU/B,GACpBE,KAAKF,QAAUA,KAMhBL,SADEqC,IAAI,SAAU,kBAAmBzC","file":"CraftAssetFiles.min.js","sourcesContent":["var plugin = $.extend({}, Craft.Redactor.PluginBase, {\n  title: 'file',\n  apiTarget: 'plugin.craftAssetFiles.showModal',\n  icon: '<i class=\"re-icon-file\"></i>',\n  volumes: null,\n\n  showModal: function () {\n    this.saveSelection(this.app);\n\n    if (typeof this.assetSelectionModal === 'undefined') {\n      var refHandle = arguments.refHandle;\n      this.assetSelectionModal = Craft.createElementSelectorModal(\n        'craft\\\\elements\\\\Asset',\n        {\n          storageKey: 'RedactorInput.LinkToAsset',\n          sources: this.volumes,\n          criteria: {siteId: this.elementSiteId},\n          onSelect: $.proxy(function (elements) {\n            if (elements.length) {\n              this.restoreSelection(this.app);\n              const element = elements[0];\n              const selectedText = this.app.selection.getText();\n              const data = {\n                url: element.url + '#asset:' + element.id,\n                text: selectedText.length > 0 ? selectedText : element.label,\n              };\n              this.app.api('module.link.insert', data);\n            }\n          }, this),\n          closeOtherModals: false,\n        }\n      );\n    } else {\n      this.assetSelectionModal.show();\n    }\n  },\n\n  setVolumes: function (volumes) {\n    this.volumes = volumes;\n  },\n});\n\n(function ($R) {\n  $R.add('plugin', 'craftAssetFiles', plugin);\n})(Redactor);\n"]}