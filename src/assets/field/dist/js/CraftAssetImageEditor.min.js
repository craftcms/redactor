var plugin=$.extend({},Craft.Redactor.PluginBase,{assetId:null,start:function(){},open:function(e){this.assetId=e;var t={allowSavingAsNew:!1,onSave:this.reloadImage.bind(this),allowDegreeFractions:Craft.isImagick};new Craft.AssetImageEditor(e,t)},reloadImage:function(){var e=this.app.editor.getElement().find("[data-image]"),t=function(e){var t=e.src.match(/(.*)#asset:(\d+)(:transform:(.*))?/i);if(t&&t[2]==this.assetId)if(t[4]){var a={assetId:t[2],handle:t[4]};Craft.postActionRequest("assets/generate-transform",a,function(a){e.src=a.url+"?"+(new Date).getTime()+"#asset:"+t[2]+":transform:"+t[4]})}else e.src=t[1]+"?"+(new Date).getTime()+"#asset:"+t[2]}.bind(this);for(var a in e.nodes)t(a=e.nodes[a]);this.app.storage.observeImages()}});Redactor.add("plugin","craftAssetImageEditor",plugin);
//# sourceMappingURL=CraftAssetImageEditor.min.js.map
