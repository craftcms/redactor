{"version":3,"sources":["PluginBase.js"],"names":["Craft","Redactor","PluginBase","app","title","apiTarget","icon","elementSiteId","init","this","start","lang","get","overrideButton","replaceButton","previousButton","toolbar","getButton","$icon","placeholderKey","placeholder","addButtonAfter","remove","buttonData","api","button","setIcon","addButton","buttonName","index","position","$el","allButtons","getButtonsKeys","getButtons","length","$","setElementSiteId","siteId","registerCmdS","saveCb","closeCb","Garnish","shortcutManager","addLayer","registerShortcut","keyCode","S_KEY","ctrl","ESC_KEY"],"mappings":"AAAAA,MAAMC,SAAW,GAEjBD,MAAMC,SAASC,WAAa,CACxBC,IAAK,KACLC,MAAO,KACPC,UAAW,KACXC,KAAM,KACNC,cAAe,KAEfC,KAAM,SAASL,GACXM,KAAKN,IAAMA,GAGfO,MAAO,WACHD,KAAKL,MAAQK,KAAKN,IAAIQ,KAAKC,IAAIH,KAAKL,QAGxCS,eAAgB,SAAUC,GACtB,IAAIC,EAAiBN,KAAKN,IAAIa,QAAQC,UAAUH,GAEhD,GAAKC,EAAL,CAKA,IAAIT,EAAOS,EAAeG,MAAMN,IAAI,GAEhCO,EAAiBL,EAAc,eAC/BM,EAAcX,KAAKN,IAAIa,QAAQK,eAAeP,EAAeK,EAAgB,CAACf,MAAOK,KAAKL,QAC9FW,EAAeO,SAEf,IAAIC,EAAa,CACbnB,MAAOK,KAAKL,MACZoB,IAAKf,KAAKJ,WAIVoB,EAAShB,KAAKN,IAAIa,QAAQK,eAAeF,EAAgBL,EAAeS,GAC5EH,EAAYE,SAEZG,EAAOC,QAAQpB,QAnBXG,KAAKkB,UAAUb,IAsBvBa,UAAW,SAAUC,EAAYC,GAC7B,IAQIC,EAAUC,EARVC,EAAavB,KAAKN,IAAIa,QAAQiB,iBAE9BV,EAAa,CACbnB,MAAOK,KAAKL,MACZoB,IAAKf,KAAKJ,gBAMO,IAAVwB,KACHG,EAAavB,KAAKN,IAAIa,QAAQkB,cAEnBC,OAASN,IACpBC,EAAW,SACXC,EAAMC,EAAWH,KAIZpB,KAAKN,IAAIa,QAAQW,UAAUC,EAAYL,EAAYO,EAAUC,GACnEL,QAAQU,EAAE,qBAAqBR,EAAW,UAAUhB,IAAI,KAGnEyB,iBAAkB,SAAUC,GACxB7B,KAAKF,cAAgB+B,GAGzBC,aAAc,CAACC,EAAQC,KAEnBC,QAAQC,gBAAgBC,WAGxBF,QAAQC,gBAAgBE,iBAAiB,CAACC,QAASJ,QAAQK,MAAOC,MAAM,GAAO,KAC3ER,MAIJE,QAAQC,gBAAgBE,iBAAiBH,QAAQO,QAAS,KACtDR","file":"PluginBase.min.js","sourcesContent":["Craft.Redactor = {};\n\nCraft.Redactor.PluginBase = {\n    app: null,\n    title: null,\n    apiTarget: null,\n    icon: null,\n    elementSiteId: null,\n\n    init: function(app) {\n        this.app = app;\n    },\n\n    start: function() {\n        this.title = this.app.lang.get(this.title);\n    },\n\n    overrideButton: function (replaceButton) {\n        var previousButton = this.app.toolbar.getButton(replaceButton);\n\n        if (!previousButton) {\n            this.addButton(replaceButton);\n            return;\n        }\n\n        var icon = previousButton.$icon.get(0);\n\n        var placeholderKey = replaceButton+'_placeholder';\n        var placeholder = this.app.toolbar.addButtonAfter(replaceButton, placeholderKey, {title: this.title});\n        previousButton.remove();\n\n        var buttonData = {\n            title: this.title,\n            api: this.apiTarget\n        };\n\n        // Create the new button\n        var button = this.app.toolbar.addButtonAfter(placeholderKey, replaceButton, buttonData);\n        placeholder.remove();\n\n        button.setIcon(icon);\n    },\n\n    addButton: function (buttonName, index) {\n        var allButtons = this.app.toolbar.getButtonsKeys();\n\n        var buttonData = {\n            title: this.title,\n            api: this.apiTarget\n        };\n\n        // Figure out where to put it\n        var position, $el;\n\n        if (typeof index !== 'undefined') {\n            var allButtons = this.app.toolbar.getButtons();\n\n            if (allButtons.length > index) {\n                position = 'before';\n                $el = allButtons[index];\n            }\n        }\n\n        var button = this.app.toolbar.addButton(buttonName, buttonData, position, $el);\n        button.setIcon($('<i class=\"re-icon-'+buttonName+'\"></i>').get(0));\n    },\n\n    setElementSiteId: function (siteId) {\n        this.elementSiteId = siteId;\n    },\n\n    registerCmdS: (saveCb, closeCb) => {\n        // Add a new layer\n        Garnish.shortcutManager.addLayer();\n\n        // Trigger the save callback on Cmd+S\n        Garnish.shortcutManager.registerShortcut({keyCode: Garnish.S_KEY, ctrl: true}, () => {\n            saveCb();\n        });\n\n        // Trigger the close callback on Esc\n        Garnish.shortcutManager.registerShortcut(Garnish.ESC_KEY, () => {\n            closeCb();\n        });\n    }\n};\n"]}